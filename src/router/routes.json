{
    "/": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "Anyone can access",
                        "rule": "public"
                    }
                ]
            }
        }
    },
    "/product/:id": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "Anyone can view products",
                        "rule": "public"
                    }
                ]
            }
        }
    },
    "/category/:category": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "Anyone can browse categories",
                        "rule": "public"
                    }
                ]
            }
        }
    },
    "/login": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "Login page is public",
                        "rule": "public"
                    }
                ]
            }
        }
    },
    "/signup": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "Signup page is public",
                        "rule": "public"
                    }
                ]
            }
        }
    },
    "/callback": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "Auth callback is public",
                        "rule": "public"
                    }
                ]
            }
        }
    },
    "/error": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "Error page is public",
                        "rule": "public"
                    }
                ]
            }
        }
    },
    "/search": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "User must be logged in",
                        "rule": "authenticated"
                    }
                ]
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=authentication_required"
            }
        }
    },
    "/wishlist": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "User must be logged in",
                        "rule": "authenticated"
                    }
                ]
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=authentication_required"
            }
        }
    },
    "/deals": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "User must be logged in",
                        "rule": "authenticated"
                    }
                ]
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=authentication_required"
            }
        }
    },
    "/orders": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "User must be logged in",
                        "rule": "authenticated"
                    }
                ]
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=authentication_required"
            }
        }
    },
    "/checkout": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "User must be logged in",
                        "rule": "authenticated"
                    }
                ]
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=authentication_required"
            }
        }
    },
    "/checkout/*": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "User must be logged in",
                        "rule": "authenticated"
                    }
                ]
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=authentication_required"
            }
        }
    },
    "/admin": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "User must be logged in",
                        "rule": "authenticated"
                    },
                    {
                        "label": "Role must be Admin",
                        "rule": "emailAddress == \"admin@example.com\""
                    }
                ],
                "operator": "AND"
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=admin_access_required"
            },
            "excludeRedirectQuery": true
        }
    },
    "/admin/*": {
        "allow": {
            "function": "isCEO",
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=admin_access_required"
            },
            "excludeRedirectQuery": true
        }
    },
    "/admin/**/*": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "User must be logged in",
                        "rule": "authenticated"
                    },
                    {
                        "label": "Role must be Admin",
                        "rule": "accounts[0].profile.name == 'CEO'"
                    }
                ],
                "operator": "AND"
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=admin_access_required"
            },
            "excludeRedirectQuery": true
        }
    },
    "/external": {
        "allow": {
            "when": {
                "conditions": [
                    {
                        "label": "Must be external user",
                        "rule": "userMetadata.isExternal"
                    }
                ]
            },
            "redirectOnDeny": {
                "default": "/login",
                "permission": "/error?message=internal_users_only"
            },
            "excludeRedirectQuery": true
        }
    }
}